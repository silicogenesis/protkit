<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>protkit.structure.chain API documentation</title>
<meta name="description" content="Implements class `Chain` to represent a chain in a protein." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>protkit.structure.chain</code></h1>
</header>
<section id="section-intro">
<p>Implements class <code><a title="protkit.structure.chain.Chain" href="#protkit.structure.chain.Chain">Chain</a></code> to represent a chain in a protein.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#!/usr/bin/env python3
# -*- coding:utf-8 -*-
# Authors:  Fred Senekal (FS)
# Contact:  fred@silicogenesis.com
# License:  GPLv3

&#34;&#34;&#34;
Implements class `Chain` to represent a chain in a protein.
&#34;&#34;&#34;

from __future__ import annotations
from typing import List, Dict, Set, Optional, TYPE_CHECKING, Any, Iterator, Union
from copy import deepcopy
from collections import defaultdict

from protkit.structure.residue import Residue
from protkit.structure.atom import Atom
from protkit.seq.sequence import Sequence

if TYPE_CHECKING:
    from protkit.structure.protein import Protein


class Chain:
    # ------------------------------------------------------------
    # Constructor
    # ------------------------------------------------------------
    def __init__(self,
                 # Core
                 chain_id: str,
                 # Optional
                 protein: Optional[Protein] = None
                 ) -&gt; None:
        &#34;&#34;&#34;
        Constructor for the Chain class.

        Args:
            chain_id (str): The chain&#39;s ID.
            protein (Optional[Protein]): The chain&#39;s protein.

        Returns:
            None
        &#34;&#34;&#34;

        self._chain_id: str = chain_id
        self._residues: List[Residue] = []
        self._protein: Optional[Protein] = protein

    def copy(self):
        &#34;&#34;&#34;
        Returns a deep copy of the chain, excluding the protein.

        Returns:
            Chain: A deep copy of the chain.
        &#34;&#34;&#34;
        protein = self._protein
        self._protein = None
        chain = deepcopy(self)
        self._protein = protein
        return chain

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s ID.
    # - id (property)
    # - chain_id (property)
    # - chain_id (setter)
    # - sequence (property)
    # ------------------------------------------------------------

    @property
    def id(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s ID, which is the chain ID if the chain
        is not part of a protein, or the protein ID + chain ID if
        the chain is part of a protein.

        Returns:
            str: The chain&#39;s ID.
        &#34;&#34;&#34;
        if self._protein is None:
            return self._chain_id
        elif self._protein.id is None:
            return self._chain_id
        else:
            return self._protein.id + &#34;:&#34; + self._chain_id

    @property
    def chain_id(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s ID.

        Returns:
            str: The chain&#39;s ID.
        &#34;&#34;&#34;
        return self._chain_id

    @chain_id.setter
    def chain_id(self, chain_id: str) -&gt; None:
        &#34;&#34;&#34;
        Sets the chain&#39;s ID.

        Args:
            chain_id (str): The chain&#39;s ID.

        Returns:
            None
        &#34;&#34;&#34;
        self._chain_id = chain_id

    @property
    def sequence(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s sequence.

        Returns:
            str: The chain&#39;s sequence.
        &#34;&#34;&#34;
        sequence = [residue.short_code for residue in self._residues]
        sequence = &#34;&#34;.join(sequence)
        return sequence

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s protein.
    # - protein (property)
    # - protein (setter)
    # ------------------------------------------------------------

    @property
    def protein(self) -&gt; Protein:
        &#34;&#34;&#34;
        Returns the chain&#39;s protein.

        Returns:
            Protein: The chain&#39;s protein.
        &#34;&#34;&#34;
        return self._protein

    @protein.setter
    def protein(self, protein: Protein) -&gt; None:
        &#34;&#34;&#34;
        Sets the chain&#39;s protein.

        Args:
            protein (Protein): The chain&#39;s protein.

        Returns:
            None
        &#34;&#34;&#34;
        self._protein = protein

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s residues.
    # Create
    # - add_residue
    # Read
    # - residues (property, iterator)
    # - num_residues (property)
    # - num_hetero_residues (property)
    # - num_water_residues (property)
    # - num_disordered_residues (property)
    # - num_residues_by_type (property)
    # - get_residue
    # - filter_residues (iterator)
    # - seqres_analysis
    # - assign_segments
    # Update
    # - renumber_residues
    # Delete
    # - remove_hetero_residues
    # ------------------------------------------------------------

    def add_residue(self, residue: Residue) -&gt; Residue:
        &#34;&#34;&#34;
        Adds a residue to the end of the chain.

        Args:
            residue (Residue): The residue to be added.

        Returns:
            Residue: The residue that was added.
        &#34;&#34;&#34;
        self._residues.append(residue)
        residue.chain = self
        return residue

    @property
    def residues(self) -&gt; Iterator[Residue]:
        &#34;&#34;&#34;
        Returns an iterator over the chain&#39;s residues.

        Yields:
            Residue: The next residue in the chain.
        &#34;&#34;&#34;
        for residue in self._residues:
            yield residue

    @property
    def num_residues(self):
        &#34;&#34;&#34;
        Returns the number of residues in the chain.

        Returns:
            int: The number of residues in the chain.
        &#34;&#34;&#34;
        return len(self._residues)

    @property
    def num_disordered_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of disordered residues in the chain.

        Returns:
            int: The number of disordered residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.is_disordered:
                count += 1
        return count

    @property
    def num_hetero_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hetero residues in the chain.

        Returns:
            int: The number of hetero residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.is_hetero:
                count += 1
        return count

    @property
    def num_water_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of water residues in the chain.

        Returns:
            int: The number of water residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.residue_type == &#34;HOH&#34;:
                count += 1
        return count

    @property
    def num_residues_by_type(self) -&gt; Dict[str, int]:
        &#34;&#34;&#34;
        Returns the number of residues in the chain by residue type.

        Returns:
            Dict[str, int]: The number of residues in the chain by residue type.
        &#34;&#34;&#34;
        num_resides = defaultdict(int)
        for residue in self._residues:
            num_resides[residue.residue_type] += 1
        return num_resides

    def get_residue(self, index) -&gt; Residue:
        &#34;&#34;&#34;
        Returns the residue at the specified index (0-based).

        Args:
            index (int): The index of the residue.

        Returns:
            Residue: The residue at the specified index.
        &#34;&#34;&#34;
        if (index &gt; len(self._residues) - 1) or (index &lt; 0):
            raise IndexError(&#34;Residue index out of range.&#34;)

        return self._residues[index]

    def filter_residues(self, residue_criteria: Optional[List] = None) -&gt; List[Residue]:
        &#34;&#34;&#34;
        Yields residues that match the specified criteria.

        Args:
            residue_criteria (Optional[List]): List of residue criteria.

        Yields:
            Residue: The next residue that matches the specified criteria.
        &#34;&#34;&#34;
        if residue_criteria is None:
            residue_criteria = []
        for residue in self._residues:
            match = True
            for key, value in residue_criteria:
                if type(value) is list:
                    if residue.get_attribute(key) not in value:
                        match = False
                        break
                elif residue.get_attribute(key) != value:
                    match = False
                    break
            if match:
                yield residue

    def seqres_analysis(self):
        &#34;&#34;&#34;
        Compares the sequence of the chain to the SEQRES record.
        &#34;&#34;&#34;
        sequence_residues = self.get_attribute(&#34;seqres&#34;)
        structure_residues = [residue.residue_type for residue in self._residues if not residue.is_hetero]
        alignment1, alignment2 = Sequence.align(sequence_residues, structure_residues)
        return alignment1, alignment2

    def renumber_residues(self, new_numbers: Optional[List[int]] = None) -&gt; None:
        &#34;&#34;&#34;
        Renumbers the residues in the chain. Residues are numbered
        sequentially, starting at 1.  If new_numbers is not specified,
        the residues are numbered sequentially, starting at 1.
        Insertion codes are removed.

        Args:
            new_numbers (Optional[List[int]]): List of new residue numbers.
                If not specified, the residues are numbered sequentially,
                starting at 1.

        Returns:
            None

        Raises:
            None
        &#34;&#34;&#34;
        if new_numbers is None:
            new_numbers = list(range(1, len(self._residues) + 1))

        for i in range(len(self._residues)):
            self._residues[i].sequence_no = new_numbers[i]
            self._residues[i].insertion_code = &#34;&#34;

    def remove_hetero_residues(self, hetero_residue_types: Optional[Union[str, List[str]]] = None) -&gt; None:
        &#34;&#34;&#34;
        Removes hetero residues from the chain.

        Args:
            hetero_residue_types (Optional[Union[str, List[str]]]): The residue types to be removed.
                If not specified, all hetero residues are removed.

        Returns:
            None
        &#34;&#34;&#34;
        if hetero_residue_types is None:
            self._residues = [residue for residue in self._residues if not residue.is_hetero]
        else:
            if type(hetero_residue_types) is str:
                hetero_residue_types = [hetero_residue_types]
            self._residues = [residue for residue in self._residues if residue.residue_type not in hetero_residue_types]

    def remove_water_residues(self) -&gt; None:
        &#34;&#34;&#34;
        Removes water residues from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        self._residues = [residue for residue in self._residues if not residue.residue_type == &#34;HOH&#34;]

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s atoms.
    # Create
    # Read
    # - atoms (property, iterator)
    # - num_atoms (property)
    # - num_heavy_atoms (property)
    # - num_hydrogen_atoms (property)
    # - num_disordered_atoms (property)
    # - num_hetero_atoms (property)
    # - filter_atoms (iterator)
    # - missing_heavy_atom_types
    # - extra_heavy_atom_types
    # - missing_hydrogen_atom_types
    # - extra_hydrogen_atom_types
    # Update
    # - fix_disordered_atoms
    # Delete
    # - remove_atoms
    # - remove_hydrogen_atoms
    # - keep_atoms
    # - keep_backbone_atoms
    # ------------------------------------------------------------

    @property
    def atoms(self) -&gt; Iterator[Atom]:
        &#34;&#34;&#34;
        Returns an iterator over the chain&#39;s atoms.

        Yields:
            Atom: The next atom in the chain.
        &#34;&#34;&#34;
        for residue in self._residues:
            for atom in residue.atoms:
                yield atom

    @property
    def num_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of atoms in the chain.

        Returns:
            int: The number of atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_atoms
        return count

    @property
    def num_heavy_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of heavy atoms in the chain.

        Returns:
            int: The number of heavy atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_heavy_atoms
        return count

    @property
    def num_hydrogen_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hydrogen atoms in the chain.

        Returns:
            int: The number of hydrogen atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_hydrogen_atoms
        return count

    @property
    def num_disordered_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of disordered atoms in the chain.

        Returns:
            int: The number of disordered atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_disordered_atoms
        return count

    @property
    def num_hetero_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hetero atoms in the chain.

        Returns:
            int: The number of hetero atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_hetero_atoms
        return count

    def filter_atoms(self,
                     atom_criteria: Optional[List] = None,
                     residue_criteria: Optional[List] = None) -&gt; Iterator[Atom]:
        &#34;&#34;&#34;
        Yields atoms that match the specified criteria.

        Args:
            atom_criteria (Optional[List]): List of atom criteria.
            residue_criteria (Optional[List]): List of residue criteria.

        Yields:
            Atom: The next atom that matches the specified criteria.
        &#34;&#34;&#34;
        for residue in self.filter_residues(residue_criteria):
            for atom in residue.filter_atoms(atom_criteria):
                yield atom

    def missing_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of missing heavy atom types.

        Returns:
            Dict[str, Set[str]]: A list of missing heavy atom types.
        &#34;&#34;&#34;
        missing_atom_types = {}
        for residue in self._residues:
            missing = residue.missing_heavy_atom_types()
            if len(missing) &gt; 0:
                missing_atom_types[residue.residue_code] = missing
        return missing_atom_types

    def extra_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of extra heavy atom types.

        Returns:
            Dict[str, Set[str]]: A list of extra heavy atom types.
        &#34;&#34;&#34;
        extra_atom_types = {}
        for residue in self._residues:
            extra = residue.extra_heavy_atom_types()
            if len(extra) &gt; 0:
                extra_atom_types[residue.residue_code] = extra
        return extra_atom_types

    def missing_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of missing hydrogen atom types.

        Returns:
            Dict[str, Set[str]]: A list of missing hydrogen atom types.
        &#34;&#34;&#34;
        missing_atom_types = {}
        for residue in self._residues:
            missing = residue.missing_hydrogen_atom_types()
            if len(missing) &gt; 0:
                missing_atom_types[residue.residue_code] = missing
        return missing_atom_types

    def extra_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of extra hydrogen atom types.

        Returns:
            Dict[str, Set[str]]: A list of extra hydrogen atom types.
        &#34;&#34;&#34;
        extra_atom_types = {}
        for residue in self._residues:
            extra = residue.extra_hydrogen_atom_types()
            if len(extra) &gt; 0:
                extra_atom_types[residue.residue_code] = extra
        return extra_atom_types

    def fix_disordered_atoms(self) -&gt; None:
        &#34;&#34;&#34;
        Fixes disordered atoms in the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.fix_disordered_atoms()

    def remove_atoms(self, atom_types: List[str]) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Args:
            atom_types (List[str]): The atom types to be removed.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.remove_atoms(atom_types)

    def remove_hydrogen_atoms(self):
        &#34;&#34;&#34;
        Removes hydrogen atoms from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.remove_hydrogen_atoms()

    def keep_atoms(self, atom_types: List[str]) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Args:
            atom_types (List[str]): The atom types to be kept.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.keep_atoms(atom_types)

    def keep_backbone_atoms(self) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.keep_backbone_atoms()

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s attributes.
    # - has_attribute
    # - get_attribute
    # - set_attribute
    # - delete_attribute
    # - sum_attribute
    # ------------------------------------------------------------

    def has_attribute(self, key: str) -&gt; bool:
        &#34;&#34;&#34;
        Returns True if the chain has the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            bool: True if the chain has the specified attribute.
        &#34;&#34;&#34;
        return hasattr(self, &#34;_&#34; + key)

    def get_attribute(self, key: str) -&gt; Any:
        &#34;&#34;&#34;
        Returns the value of the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            Any: The value of the specified attribute.

        Raises:
            AttributeError: If the attribute does not exist.
        &#34;&#34;&#34;
        return getattr(self, &#34;_&#34; + key)

    def set_attribute(self, key: str, value: Any) -&gt; None:
        &#34;&#34;&#34;
        Sets the value of the specified attribute.

        Args:
            key (str): The name of the attribute.
            value (Any): The value of the attribute.

        Returns:
            None
        &#34;&#34;&#34;
        if value is not None:
            setattr(self, &#34;_&#34; + key, value)

    def delete_attribute(self, key: str) -&gt; None:
        &#34;&#34;&#34;
        Deletes the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            None
        &#34;&#34;&#34;
        if hasattr(self, &#34;_&#34; + key):
            delattr(self, &#34;_&#34; + key)

    def sum_attribute(self, key: str) -&gt; None:
        &#34;&#34;&#34;
        Sums the value of the specified attribute.
        &#34;&#34;&#34;
        atrribute_sum = 0.0
        for residue in self._residues:
            if not hasattr(residue, key):
                residue.sum_attribute(key)
            atrribute_sum += residue.get_attribute(key)
        self.set_attribute(key, atrribute_sum)

    # ------------------------------------------------------------
    # Reporting
    # ------------------------------------------------------------

    def summary(self) -&gt; str:
        text = [
            f&#34;Chain ID: {self.id}&#34;,
            f&#34;Number of residues: {self.num_residues}&#34;,
            f&#34;Number of atoms: {self.num_atoms}&#34;
        ]

        return &#34;\n&#34;.join(text)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="protkit.structure.chain.Chain"><code class="flex name class">
<span>class <span class="ident">Chain</span></span>
<span>(</span><span>chain_id: str, protein: Optional[Protein] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Constructor for the Chain class.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>chain_id</code></strong> :&ensp;<code>str</code></dt>
<dd>The chain's ID.</dd>
<dt><strong><code>protein</code></strong> :&ensp;<code>Optional[Protein]</code></dt>
<dd>The chain's protein.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Chain:
    # ------------------------------------------------------------
    # Constructor
    # ------------------------------------------------------------
    def __init__(self,
                 # Core
                 chain_id: str,
                 # Optional
                 protein: Optional[Protein] = None
                 ) -&gt; None:
        &#34;&#34;&#34;
        Constructor for the Chain class.

        Args:
            chain_id (str): The chain&#39;s ID.
            protein (Optional[Protein]): The chain&#39;s protein.

        Returns:
            None
        &#34;&#34;&#34;

        self._chain_id: str = chain_id
        self._residues: List[Residue] = []
        self._protein: Optional[Protein] = protein

    def copy(self):
        &#34;&#34;&#34;
        Returns a deep copy of the chain, excluding the protein.

        Returns:
            Chain: A deep copy of the chain.
        &#34;&#34;&#34;
        protein = self._protein
        self._protein = None
        chain = deepcopy(self)
        self._protein = protein
        return chain

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s ID.
    # - id (property)
    # - chain_id (property)
    # - chain_id (setter)
    # - sequence (property)
    # ------------------------------------------------------------

    @property
    def id(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s ID, which is the chain ID if the chain
        is not part of a protein, or the protein ID + chain ID if
        the chain is part of a protein.

        Returns:
            str: The chain&#39;s ID.
        &#34;&#34;&#34;
        if self._protein is None:
            return self._chain_id
        elif self._protein.id is None:
            return self._chain_id
        else:
            return self._protein.id + &#34;:&#34; + self._chain_id

    @property
    def chain_id(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s ID.

        Returns:
            str: The chain&#39;s ID.
        &#34;&#34;&#34;
        return self._chain_id

    @chain_id.setter
    def chain_id(self, chain_id: str) -&gt; None:
        &#34;&#34;&#34;
        Sets the chain&#39;s ID.

        Args:
            chain_id (str): The chain&#39;s ID.

        Returns:
            None
        &#34;&#34;&#34;
        self._chain_id = chain_id

    @property
    def sequence(self) -&gt; str:
        &#34;&#34;&#34;
        Returns the chain&#39;s sequence.

        Returns:
            str: The chain&#39;s sequence.
        &#34;&#34;&#34;
        sequence = [residue.short_code for residue in self._residues]
        sequence = &#34;&#34;.join(sequence)
        return sequence

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s protein.
    # - protein (property)
    # - protein (setter)
    # ------------------------------------------------------------

    @property
    def protein(self) -&gt; Protein:
        &#34;&#34;&#34;
        Returns the chain&#39;s protein.

        Returns:
            Protein: The chain&#39;s protein.
        &#34;&#34;&#34;
        return self._protein

    @protein.setter
    def protein(self, protein: Protein) -&gt; None:
        &#34;&#34;&#34;
        Sets the chain&#39;s protein.

        Args:
            protein (Protein): The chain&#39;s protein.

        Returns:
            None
        &#34;&#34;&#34;
        self._protein = protein

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s residues.
    # Create
    # - add_residue
    # Read
    # - residues (property, iterator)
    # - num_residues (property)
    # - num_hetero_residues (property)
    # - num_water_residues (property)
    # - num_disordered_residues (property)
    # - num_residues_by_type (property)
    # - get_residue
    # - filter_residues (iterator)
    # - seqres_analysis
    # - assign_segments
    # Update
    # - renumber_residues
    # Delete
    # - remove_hetero_residues
    # ------------------------------------------------------------

    def add_residue(self, residue: Residue) -&gt; Residue:
        &#34;&#34;&#34;
        Adds a residue to the end of the chain.

        Args:
            residue (Residue): The residue to be added.

        Returns:
            Residue: The residue that was added.
        &#34;&#34;&#34;
        self._residues.append(residue)
        residue.chain = self
        return residue

    @property
    def residues(self) -&gt; Iterator[Residue]:
        &#34;&#34;&#34;
        Returns an iterator over the chain&#39;s residues.

        Yields:
            Residue: The next residue in the chain.
        &#34;&#34;&#34;
        for residue in self._residues:
            yield residue

    @property
    def num_residues(self):
        &#34;&#34;&#34;
        Returns the number of residues in the chain.

        Returns:
            int: The number of residues in the chain.
        &#34;&#34;&#34;
        return len(self._residues)

    @property
    def num_disordered_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of disordered residues in the chain.

        Returns:
            int: The number of disordered residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.is_disordered:
                count += 1
        return count

    @property
    def num_hetero_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hetero residues in the chain.

        Returns:
            int: The number of hetero residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.is_hetero:
                count += 1
        return count

    @property
    def num_water_residues(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of water residues in the chain.

        Returns:
            int: The number of water residues in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            if residue.residue_type == &#34;HOH&#34;:
                count += 1
        return count

    @property
    def num_residues_by_type(self) -&gt; Dict[str, int]:
        &#34;&#34;&#34;
        Returns the number of residues in the chain by residue type.

        Returns:
            Dict[str, int]: The number of residues in the chain by residue type.
        &#34;&#34;&#34;
        num_resides = defaultdict(int)
        for residue in self._residues:
            num_resides[residue.residue_type] += 1
        return num_resides

    def get_residue(self, index) -&gt; Residue:
        &#34;&#34;&#34;
        Returns the residue at the specified index (0-based).

        Args:
            index (int): The index of the residue.

        Returns:
            Residue: The residue at the specified index.
        &#34;&#34;&#34;
        if (index &gt; len(self._residues) - 1) or (index &lt; 0):
            raise IndexError(&#34;Residue index out of range.&#34;)

        return self._residues[index]

    def filter_residues(self, residue_criteria: Optional[List] = None) -&gt; List[Residue]:
        &#34;&#34;&#34;
        Yields residues that match the specified criteria.

        Args:
            residue_criteria (Optional[List]): List of residue criteria.

        Yields:
            Residue: The next residue that matches the specified criteria.
        &#34;&#34;&#34;
        if residue_criteria is None:
            residue_criteria = []
        for residue in self._residues:
            match = True
            for key, value in residue_criteria:
                if type(value) is list:
                    if residue.get_attribute(key) not in value:
                        match = False
                        break
                elif residue.get_attribute(key) != value:
                    match = False
                    break
            if match:
                yield residue

    def seqres_analysis(self):
        &#34;&#34;&#34;
        Compares the sequence of the chain to the SEQRES record.
        &#34;&#34;&#34;
        sequence_residues = self.get_attribute(&#34;seqres&#34;)
        structure_residues = [residue.residue_type for residue in self._residues if not residue.is_hetero]
        alignment1, alignment2 = Sequence.align(sequence_residues, structure_residues)
        return alignment1, alignment2

    def renumber_residues(self, new_numbers: Optional[List[int]] = None) -&gt; None:
        &#34;&#34;&#34;
        Renumbers the residues in the chain. Residues are numbered
        sequentially, starting at 1.  If new_numbers is not specified,
        the residues are numbered sequentially, starting at 1.
        Insertion codes are removed.

        Args:
            new_numbers (Optional[List[int]]): List of new residue numbers.
                If not specified, the residues are numbered sequentially,
                starting at 1.

        Returns:
            None

        Raises:
            None
        &#34;&#34;&#34;
        if new_numbers is None:
            new_numbers = list(range(1, len(self._residues) + 1))

        for i in range(len(self._residues)):
            self._residues[i].sequence_no = new_numbers[i]
            self._residues[i].insertion_code = &#34;&#34;

    def remove_hetero_residues(self, hetero_residue_types: Optional[Union[str, List[str]]] = None) -&gt; None:
        &#34;&#34;&#34;
        Removes hetero residues from the chain.

        Args:
            hetero_residue_types (Optional[Union[str, List[str]]]): The residue types to be removed.
                If not specified, all hetero residues are removed.

        Returns:
            None
        &#34;&#34;&#34;
        if hetero_residue_types is None:
            self._residues = [residue for residue in self._residues if not residue.is_hetero]
        else:
            if type(hetero_residue_types) is str:
                hetero_residue_types = [hetero_residue_types]
            self._residues = [residue for residue in self._residues if residue.residue_type not in hetero_residue_types]

    def remove_water_residues(self) -&gt; None:
        &#34;&#34;&#34;
        Removes water residues from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        self._residues = [residue for residue in self._residues if not residue.residue_type == &#34;HOH&#34;]

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s atoms.
    # Create
    # Read
    # - atoms (property, iterator)
    # - num_atoms (property)
    # - num_heavy_atoms (property)
    # - num_hydrogen_atoms (property)
    # - num_disordered_atoms (property)
    # - num_hetero_atoms (property)
    # - filter_atoms (iterator)
    # - missing_heavy_atom_types
    # - extra_heavy_atom_types
    # - missing_hydrogen_atom_types
    # - extra_hydrogen_atom_types
    # Update
    # - fix_disordered_atoms
    # Delete
    # - remove_atoms
    # - remove_hydrogen_atoms
    # - keep_atoms
    # - keep_backbone_atoms
    # ------------------------------------------------------------

    @property
    def atoms(self) -&gt; Iterator[Atom]:
        &#34;&#34;&#34;
        Returns an iterator over the chain&#39;s atoms.

        Yields:
            Atom: The next atom in the chain.
        &#34;&#34;&#34;
        for residue in self._residues:
            for atom in residue.atoms:
                yield atom

    @property
    def num_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of atoms in the chain.

        Returns:
            int: The number of atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_atoms
        return count

    @property
    def num_heavy_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of heavy atoms in the chain.

        Returns:
            int: The number of heavy atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_heavy_atoms
        return count

    @property
    def num_hydrogen_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hydrogen atoms in the chain.

        Returns:
            int: The number of hydrogen atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_hydrogen_atoms
        return count

    @property
    def num_disordered_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of disordered atoms in the chain.

        Returns:
            int: The number of disordered atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_disordered_atoms
        return count

    @property
    def num_hetero_atoms(self) -&gt; int:
        &#34;&#34;&#34;
        Returns the number of hetero atoms in the chain.

        Returns:
            int: The number of hetero atoms in the chain.
        &#34;&#34;&#34;
        count = 0
        for residue in self._residues:
            count += residue.num_hetero_atoms
        return count

    def filter_atoms(self,
                     atom_criteria: Optional[List] = None,
                     residue_criteria: Optional[List] = None) -&gt; Iterator[Atom]:
        &#34;&#34;&#34;
        Yields atoms that match the specified criteria.

        Args:
            atom_criteria (Optional[List]): List of atom criteria.
            residue_criteria (Optional[List]): List of residue criteria.

        Yields:
            Atom: The next atom that matches the specified criteria.
        &#34;&#34;&#34;
        for residue in self.filter_residues(residue_criteria):
            for atom in residue.filter_atoms(atom_criteria):
                yield atom

    def missing_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of missing heavy atom types.

        Returns:
            Dict[str, Set[str]]: A list of missing heavy atom types.
        &#34;&#34;&#34;
        missing_atom_types = {}
        for residue in self._residues:
            missing = residue.missing_heavy_atom_types()
            if len(missing) &gt; 0:
                missing_atom_types[residue.residue_code] = missing
        return missing_atom_types

    def extra_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of extra heavy atom types.

        Returns:
            Dict[str, Set[str]]: A list of extra heavy atom types.
        &#34;&#34;&#34;
        extra_atom_types = {}
        for residue in self._residues:
            extra = residue.extra_heavy_atom_types()
            if len(extra) &gt; 0:
                extra_atom_types[residue.residue_code] = extra
        return extra_atom_types

    def missing_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of missing hydrogen atom types.

        Returns:
            Dict[str, Set[str]]: A list of missing hydrogen atom types.
        &#34;&#34;&#34;
        missing_atom_types = {}
        for residue in self._residues:
            missing = residue.missing_hydrogen_atom_types()
            if len(missing) &gt; 0:
                missing_atom_types[residue.residue_code] = missing
        return missing_atom_types

    def extra_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
        &#34;&#34;&#34;
        Returns a list of extra hydrogen atom types.

        Returns:
            Dict[str, Set[str]]: A list of extra hydrogen atom types.
        &#34;&#34;&#34;
        extra_atom_types = {}
        for residue in self._residues:
            extra = residue.extra_hydrogen_atom_types()
            if len(extra) &gt; 0:
                extra_atom_types[residue.residue_code] = extra
        return extra_atom_types

    def fix_disordered_atoms(self) -&gt; None:
        &#34;&#34;&#34;
        Fixes disordered atoms in the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.fix_disordered_atoms()

    def remove_atoms(self, atom_types: List[str]) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Args:
            atom_types (List[str]): The atom types to be removed.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.remove_atoms(atom_types)

    def remove_hydrogen_atoms(self):
        &#34;&#34;&#34;
        Removes hydrogen atoms from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.remove_hydrogen_atoms()

    def keep_atoms(self, atom_types: List[str]) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Args:
            atom_types (List[str]): The atom types to be kept.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.keep_atoms(atom_types)

    def keep_backbone_atoms(self) -&gt; None:
        &#34;&#34;&#34;
        Removes atoms from the chain.

        Returns:
            None
        &#34;&#34;&#34;
        for residue in self._residues:
            residue.keep_backbone_atoms()

    # ------------------------------------------------------------
    # Methods for managing the chain&#39;s attributes.
    # - has_attribute
    # - get_attribute
    # - set_attribute
    # - delete_attribute
    # - sum_attribute
    # ------------------------------------------------------------

    def has_attribute(self, key: str) -&gt; bool:
        &#34;&#34;&#34;
        Returns True if the chain has the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            bool: True if the chain has the specified attribute.
        &#34;&#34;&#34;
        return hasattr(self, &#34;_&#34; + key)

    def get_attribute(self, key: str) -&gt; Any:
        &#34;&#34;&#34;
        Returns the value of the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            Any: The value of the specified attribute.

        Raises:
            AttributeError: If the attribute does not exist.
        &#34;&#34;&#34;
        return getattr(self, &#34;_&#34; + key)

    def set_attribute(self, key: str, value: Any) -&gt; None:
        &#34;&#34;&#34;
        Sets the value of the specified attribute.

        Args:
            key (str): The name of the attribute.
            value (Any): The value of the attribute.

        Returns:
            None
        &#34;&#34;&#34;
        if value is not None:
            setattr(self, &#34;_&#34; + key, value)

    def delete_attribute(self, key: str) -&gt; None:
        &#34;&#34;&#34;
        Deletes the specified attribute.

        Args:
            key (str): The name of the attribute.

        Returns:
            None
        &#34;&#34;&#34;
        if hasattr(self, &#34;_&#34; + key):
            delattr(self, &#34;_&#34; + key)

    def sum_attribute(self, key: str) -&gt; None:
        &#34;&#34;&#34;
        Sums the value of the specified attribute.
        &#34;&#34;&#34;
        atrribute_sum = 0.0
        for residue in self._residues:
            if not hasattr(residue, key):
                residue.sum_attribute(key)
            atrribute_sum += residue.get_attribute(key)
        self.set_attribute(key, atrribute_sum)

    # ------------------------------------------------------------
    # Reporting
    # ------------------------------------------------------------

    def summary(self) -&gt; str:
        text = [
            f&#34;Chain ID: {self.id}&#34;,
            f&#34;Number of residues: {self.num_residues}&#34;,
            f&#34;Number of atoms: {self.num_atoms}&#34;
        ]

        return &#34;\n&#34;.join(text)</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="protkit.structure.chain.Chain.atoms"><code class="name">var <span class="ident">atoms</span> : Iterator[<a title="protkit.structure.atom.Atom" href="atom.html#protkit.structure.atom.Atom">Atom</a>]</code></dt>
<dd>
<div class="desc"><p>Returns an iterator over the chain's atoms.</p>
<h2 id="yields">Yields</h2>
<dl>
<dt><code>Atom</code></dt>
<dd>The next atom in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def atoms(self) -&gt; Iterator[Atom]:
    &#34;&#34;&#34;
    Returns an iterator over the chain&#39;s atoms.

    Yields:
        Atom: The next atom in the chain.
    &#34;&#34;&#34;
    for residue in self._residues:
        for atom in residue.atoms:
            yield atom</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.chain_id"><code class="name">var <span class="ident">chain_id</span> : str</code></dt>
<dd>
<div class="desc"><p>Returns the chain's ID.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The chain's ID.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def chain_id(self) -&gt; str:
    &#34;&#34;&#34;
    Returns the chain&#39;s ID.

    Returns:
        str: The chain&#39;s ID.
    &#34;&#34;&#34;
    return self._chain_id</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.id"><code class="name">var <span class="ident">id</span> : str</code></dt>
<dd>
<div class="desc"><p>Returns the chain's ID, which is the chain ID if the chain
is not part of a protein, or the protein ID + chain ID if
the chain is part of a protein.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The chain's ID.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def id(self) -&gt; str:
    &#34;&#34;&#34;
    Returns the chain&#39;s ID, which is the chain ID if the chain
    is not part of a protein, or the protein ID + chain ID if
    the chain is part of a protein.

    Returns:
        str: The chain&#39;s ID.
    &#34;&#34;&#34;
    if self._protein is None:
        return self._chain_id
    elif self._protein.id is None:
        return self._chain_id
    else:
        return self._protein.id + &#34;:&#34; + self._chain_id</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_atoms"><code class="name">var <span class="ident">num_atoms</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of atoms in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_atoms(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of atoms in the chain.

    Returns:
        int: The number of atoms in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        count += residue.num_atoms
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_disordered_atoms"><code class="name">var <span class="ident">num_disordered_atoms</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of disordered atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of disordered atoms in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_disordered_atoms(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of disordered atoms in the chain.

    Returns:
        int: The number of disordered atoms in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        count += residue.num_disordered_atoms
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_disordered_residues"><code class="name">var <span class="ident">num_disordered_residues</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of disordered residues in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of disordered residues in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_disordered_residues(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of disordered residues in the chain.

    Returns:
        int: The number of disordered residues in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        if residue.is_disordered:
            count += 1
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_heavy_atoms"><code class="name">var <span class="ident">num_heavy_atoms</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of heavy atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of heavy atoms in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_heavy_atoms(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of heavy atoms in the chain.

    Returns:
        int: The number of heavy atoms in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        count += residue.num_heavy_atoms
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_hetero_atoms"><code class="name">var <span class="ident">num_hetero_atoms</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of hetero atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of hetero atoms in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_hetero_atoms(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of hetero atoms in the chain.

    Returns:
        int: The number of hetero atoms in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        count += residue.num_hetero_atoms
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_hetero_residues"><code class="name">var <span class="ident">num_hetero_residues</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of hetero residues in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of hetero residues in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_hetero_residues(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of hetero residues in the chain.

    Returns:
        int: The number of hetero residues in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        if residue.is_hetero:
            count += 1
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_hydrogen_atoms"><code class="name">var <span class="ident">num_hydrogen_atoms</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of hydrogen atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of hydrogen atoms in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_hydrogen_atoms(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of hydrogen atoms in the chain.

    Returns:
        int: The number of hydrogen atoms in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        count += residue.num_hydrogen_atoms
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_residues"><code class="name">var <span class="ident">num_residues</span></code></dt>
<dd>
<div class="desc"><p>Returns the number of residues in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of residues in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_residues(self):
    &#34;&#34;&#34;
    Returns the number of residues in the chain.

    Returns:
        int: The number of residues in the chain.
    &#34;&#34;&#34;
    return len(self._residues)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_residues_by_type"><code class="name">var <span class="ident">num_residues_by_type</span> : Dict[str, int]</code></dt>
<dd>
<div class="desc"><p>Returns the number of residues in the chain by residue type.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, int]</code></dt>
<dd>The number of residues in the chain by residue type.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_residues_by_type(self) -&gt; Dict[str, int]:
    &#34;&#34;&#34;
    Returns the number of residues in the chain by residue type.

    Returns:
        Dict[str, int]: The number of residues in the chain by residue type.
    &#34;&#34;&#34;
    num_resides = defaultdict(int)
    for residue in self._residues:
        num_resides[residue.residue_type] += 1
    return num_resides</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.num_water_residues"><code class="name">var <span class="ident">num_water_residues</span> : int</code></dt>
<dd>
<div class="desc"><p>Returns the number of water residues in the chain.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>The number of water residues in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def num_water_residues(self) -&gt; int:
    &#34;&#34;&#34;
    Returns the number of water residues in the chain.

    Returns:
        int: The number of water residues in the chain.
    &#34;&#34;&#34;
    count = 0
    for residue in self._residues:
        if residue.residue_type == &#34;HOH&#34;:
            count += 1
    return count</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.protein"><code class="name">var <span class="ident">protein</span> : Protein</code></dt>
<dd>
<div class="desc"><p>Returns the chain's protein.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Protein</code></dt>
<dd>The chain's protein.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def protein(self) -&gt; Protein:
    &#34;&#34;&#34;
    Returns the chain&#39;s protein.

    Returns:
        Protein: The chain&#39;s protein.
    &#34;&#34;&#34;
    return self._protein</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.residues"><code class="name">var <span class="ident">residues</span> : Iterator[<a title="protkit.structure.residue.Residue" href="residue.html#protkit.structure.residue.Residue">Residue</a>]</code></dt>
<dd>
<div class="desc"><p>Returns an iterator over the chain's residues.</p>
<h2 id="yields">Yields</h2>
<dl>
<dt><code>Residue</code></dt>
<dd>The next residue in the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def residues(self) -&gt; Iterator[Residue]:
    &#34;&#34;&#34;
    Returns an iterator over the chain&#39;s residues.

    Yields:
        Residue: The next residue in the chain.
    &#34;&#34;&#34;
    for residue in self._residues:
        yield residue</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.sequence"><code class="name">var <span class="ident">sequence</span> : str</code></dt>
<dd>
<div class="desc"><p>Returns the chain's sequence.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>The chain's sequence.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def sequence(self) -&gt; str:
    &#34;&#34;&#34;
    Returns the chain&#39;s sequence.

    Returns:
        str: The chain&#39;s sequence.
    &#34;&#34;&#34;
    sequence = [residue.short_code for residue in self._residues]
    sequence = &#34;&#34;.join(sequence)
    return sequence</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="protkit.structure.chain.Chain.add_residue"><code class="name flex">
<span>def <span class="ident">add_residue</span></span>(<span>self, residue: Residue) ‑> <a title="protkit.structure.residue.Residue" href="residue.html#protkit.structure.residue.Residue">Residue</a></span>
</code></dt>
<dd>
<div class="desc"><p>Adds a residue to the end of the chain.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>residue</code></strong> :&ensp;<code>Residue</code></dt>
<dd>The residue to be added.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Residue</code></dt>
<dd>The residue that was added.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_residue(self, residue: Residue) -&gt; Residue:
    &#34;&#34;&#34;
    Adds a residue to the end of the chain.

    Args:
        residue (Residue): The residue to be added.

    Returns:
        Residue: The residue that was added.
    &#34;&#34;&#34;
    self._residues.append(residue)
    residue.chain = self
    return residue</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.copy"><code class="name flex">
<span>def <span class="ident">copy</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a deep copy of the chain, excluding the protein.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code><a title="protkit.structure.chain.Chain" href="#protkit.structure.chain.Chain">Chain</a></code></dt>
<dd>A deep copy of the chain.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def copy(self):
    &#34;&#34;&#34;
    Returns a deep copy of the chain, excluding the protein.

    Returns:
        Chain: A deep copy of the chain.
    &#34;&#34;&#34;
    protein = self._protein
    self._protein = None
    chain = deepcopy(self)
    self._protein = protein
    return chain</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.delete_attribute"><code class="name flex">
<span>def <span class="ident">delete_attribute</span></span>(<span>self, key: str) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Deletes the specified attribute.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>key</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_attribute(self, key: str) -&gt; None:
    &#34;&#34;&#34;
    Deletes the specified attribute.

    Args:
        key (str): The name of the attribute.

    Returns:
        None
    &#34;&#34;&#34;
    if hasattr(self, &#34;_&#34; + key):
        delattr(self, &#34;_&#34; + key)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.extra_heavy_atom_types"><code class="name flex">
<span>def <span class="ident">extra_heavy_atom_types</span></span>(<span>self) ‑> Dict[str, Set[str]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of extra heavy atom types.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, Set[str]]</code></dt>
<dd>A list of extra heavy atom types.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extra_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
    &#34;&#34;&#34;
    Returns a list of extra heavy atom types.

    Returns:
        Dict[str, Set[str]]: A list of extra heavy atom types.
    &#34;&#34;&#34;
    extra_atom_types = {}
    for residue in self._residues:
        extra = residue.extra_heavy_atom_types()
        if len(extra) &gt; 0:
            extra_atom_types[residue.residue_code] = extra
    return extra_atom_types</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.extra_hydrogen_atom_types"><code class="name flex">
<span>def <span class="ident">extra_hydrogen_atom_types</span></span>(<span>self) ‑> Dict[str, Set[str]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of extra hydrogen atom types.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, Set[str]]</code></dt>
<dd>A list of extra hydrogen atom types.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def extra_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
    &#34;&#34;&#34;
    Returns a list of extra hydrogen atom types.

    Returns:
        Dict[str, Set[str]]: A list of extra hydrogen atom types.
    &#34;&#34;&#34;
    extra_atom_types = {}
    for residue in self._residues:
        extra = residue.extra_hydrogen_atom_types()
        if len(extra) &gt; 0:
            extra_atom_types[residue.residue_code] = extra
    return extra_atom_types</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.filter_atoms"><code class="name flex">
<span>def <span class="ident">filter_atoms</span></span>(<span>self, atom_criteria: Optional[List] = None, residue_criteria: Optional[List] = None) ‑> Iterator[<a title="protkit.structure.atom.Atom" href="atom.html#protkit.structure.atom.Atom">Atom</a>]</span>
</code></dt>
<dd>
<div class="desc"><p>Yields atoms that match the specified criteria.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>atom_criteria</code></strong> :&ensp;<code>Optional[List]</code></dt>
<dd>List of atom criteria.</dd>
<dt><strong><code>residue_criteria</code></strong> :&ensp;<code>Optional[List]</code></dt>
<dd>List of residue criteria.</dd>
</dl>
<h2 id="yields">Yields</h2>
<dl>
<dt><code>Atom</code></dt>
<dd>The next atom that matches the specified criteria.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def filter_atoms(self,
                 atom_criteria: Optional[List] = None,
                 residue_criteria: Optional[List] = None) -&gt; Iterator[Atom]:
    &#34;&#34;&#34;
    Yields atoms that match the specified criteria.

    Args:
        atom_criteria (Optional[List]): List of atom criteria.
        residue_criteria (Optional[List]): List of residue criteria.

    Yields:
        Atom: The next atom that matches the specified criteria.
    &#34;&#34;&#34;
    for residue in self.filter_residues(residue_criteria):
        for atom in residue.filter_atoms(atom_criteria):
            yield atom</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.filter_residues"><code class="name flex">
<span>def <span class="ident">filter_residues</span></span>(<span>self, residue_criteria: Optional[List] = None) ‑> List[<a title="protkit.structure.residue.Residue" href="residue.html#protkit.structure.residue.Residue">Residue</a>]</span>
</code></dt>
<dd>
<div class="desc"><p>Yields residues that match the specified criteria.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>residue_criteria</code></strong> :&ensp;<code>Optional[List]</code></dt>
<dd>List of residue criteria.</dd>
</dl>
<h2 id="yields">Yields</h2>
<dl>
<dt><code>Residue</code></dt>
<dd>The next residue that matches the specified criteria.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def filter_residues(self, residue_criteria: Optional[List] = None) -&gt; List[Residue]:
    &#34;&#34;&#34;
    Yields residues that match the specified criteria.

    Args:
        residue_criteria (Optional[List]): List of residue criteria.

    Yields:
        Residue: The next residue that matches the specified criteria.
    &#34;&#34;&#34;
    if residue_criteria is None:
        residue_criteria = []
    for residue in self._residues:
        match = True
        for key, value in residue_criteria:
            if type(value) is list:
                if residue.get_attribute(key) not in value:
                    match = False
                    break
            elif residue.get_attribute(key) != value:
                match = False
                break
        if match:
            yield residue</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.fix_disordered_atoms"><code class="name flex">
<span>def <span class="ident">fix_disordered_atoms</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Fixes disordered atoms in the chain.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def fix_disordered_atoms(self) -&gt; None:
    &#34;&#34;&#34;
    Fixes disordered atoms in the chain.

    Returns:
        None
    &#34;&#34;&#34;
    for residue in self._residues:
        residue.fix_disordered_atoms()</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.get_attribute"><code class="name flex">
<span>def <span class="ident">get_attribute</span></span>(<span>self, key: str) ‑> Any</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the value of the specified attribute.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>key</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Any</code></dt>
<dd>The value of the specified attribute.</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>AttributeError</code></dt>
<dd>If the attribute does not exist.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_attribute(self, key: str) -&gt; Any:
    &#34;&#34;&#34;
    Returns the value of the specified attribute.

    Args:
        key (str): The name of the attribute.

    Returns:
        Any: The value of the specified attribute.

    Raises:
        AttributeError: If the attribute does not exist.
    &#34;&#34;&#34;
    return getattr(self, &#34;_&#34; + key)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.get_residue"><code class="name flex">
<span>def <span class="ident">get_residue</span></span>(<span>self, index) ‑> <a title="protkit.structure.residue.Residue" href="residue.html#protkit.structure.residue.Residue">Residue</a></span>
</code></dt>
<dd>
<div class="desc"><p>Returns the residue at the specified index (0-based).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>index</code></strong> :&ensp;<code>int</code></dt>
<dd>The index of the residue.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Residue</code></dt>
<dd>The residue at the specified index.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_residue(self, index) -&gt; Residue:
    &#34;&#34;&#34;
    Returns the residue at the specified index (0-based).

    Args:
        index (int): The index of the residue.

    Returns:
        Residue: The residue at the specified index.
    &#34;&#34;&#34;
    if (index &gt; len(self._residues) - 1) or (index &lt; 0):
        raise IndexError(&#34;Residue index out of range.&#34;)

    return self._residues[index]</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.has_attribute"><code class="name flex">
<span>def <span class="ident">has_attribute</span></span>(<span>self, key: str) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Returns True if the chain has the specified attribute.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>key</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>True if the chain has the specified attribute.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def has_attribute(self, key: str) -&gt; bool:
    &#34;&#34;&#34;
    Returns True if the chain has the specified attribute.

    Args:
        key (str): The name of the attribute.

    Returns:
        bool: True if the chain has the specified attribute.
    &#34;&#34;&#34;
    return hasattr(self, &#34;_&#34; + key)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.keep_atoms"><code class="name flex">
<span>def <span class="ident">keep_atoms</span></span>(<span>self, atom_types: List[str]) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Removes atoms from the chain.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>atom_types</code></strong> :&ensp;<code>List[str]</code></dt>
<dd>The atom types to be kept.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def keep_atoms(self, atom_types: List[str]) -&gt; None:
    &#34;&#34;&#34;
    Removes atoms from the chain.

    Args:
        atom_types (List[str]): The atom types to be kept.

    Returns:
        None
    &#34;&#34;&#34;
    for residue in self._residues:
        residue.keep_atoms(atom_types)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.keep_backbone_atoms"><code class="name flex">
<span>def <span class="ident">keep_backbone_atoms</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Removes atoms from the chain.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def keep_backbone_atoms(self) -&gt; None:
    &#34;&#34;&#34;
    Removes atoms from the chain.

    Returns:
        None
    &#34;&#34;&#34;
    for residue in self._residues:
        residue.keep_backbone_atoms()</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.missing_heavy_atom_types"><code class="name flex">
<span>def <span class="ident">missing_heavy_atom_types</span></span>(<span>self) ‑> Dict[str, Set[str]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of missing heavy atom types.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, Set[str]]</code></dt>
<dd>A list of missing heavy atom types.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def missing_heavy_atom_types(self) -&gt; Dict[str, Set[str]]:
    &#34;&#34;&#34;
    Returns a list of missing heavy atom types.

    Returns:
        Dict[str, Set[str]]: A list of missing heavy atom types.
    &#34;&#34;&#34;
    missing_atom_types = {}
    for residue in self._residues:
        missing = residue.missing_heavy_atom_types()
        if len(missing) &gt; 0:
            missing_atom_types[residue.residue_code] = missing
    return missing_atom_types</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.missing_hydrogen_atom_types"><code class="name flex">
<span>def <span class="ident">missing_hydrogen_atom_types</span></span>(<span>self) ‑> Dict[str, Set[str]]</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of missing hydrogen atom types.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Dict[str, Set[str]]</code></dt>
<dd>A list of missing hydrogen atom types.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def missing_hydrogen_atom_types(self) -&gt; Dict[str, Set[str]]:
    &#34;&#34;&#34;
    Returns a list of missing hydrogen atom types.

    Returns:
        Dict[str, Set[str]]: A list of missing hydrogen atom types.
    &#34;&#34;&#34;
    missing_atom_types = {}
    for residue in self._residues:
        missing = residue.missing_hydrogen_atom_types()
        if len(missing) &gt; 0:
            missing_atom_types[residue.residue_code] = missing
    return missing_atom_types</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.remove_atoms"><code class="name flex">
<span>def <span class="ident">remove_atoms</span></span>(<span>self, atom_types: List[str]) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Removes atoms from the chain.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>atom_types</code></strong> :&ensp;<code>List[str]</code></dt>
<dd>The atom types to be removed.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_atoms(self, atom_types: List[str]) -&gt; None:
    &#34;&#34;&#34;
    Removes atoms from the chain.

    Args:
        atom_types (List[str]): The atom types to be removed.

    Returns:
        None
    &#34;&#34;&#34;
    for residue in self._residues:
        residue.remove_atoms(atom_types)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.remove_hetero_residues"><code class="name flex">
<span>def <span class="ident">remove_hetero_residues</span></span>(<span>self, hetero_residue_types: Optional[Union[str, List[str]]] = None) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Removes hetero residues from the chain.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>hetero_residue_types</code></strong> :&ensp;<code>Optional[Union[str, List[str]]]</code></dt>
<dd>The residue types to be removed.
If not specified, all hetero residues are removed.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_hetero_residues(self, hetero_residue_types: Optional[Union[str, List[str]]] = None) -&gt; None:
    &#34;&#34;&#34;
    Removes hetero residues from the chain.

    Args:
        hetero_residue_types (Optional[Union[str, List[str]]]): The residue types to be removed.
            If not specified, all hetero residues are removed.

    Returns:
        None
    &#34;&#34;&#34;
    if hetero_residue_types is None:
        self._residues = [residue for residue in self._residues if not residue.is_hetero]
    else:
        if type(hetero_residue_types) is str:
            hetero_residue_types = [hetero_residue_types]
        self._residues = [residue for residue in self._residues if residue.residue_type not in hetero_residue_types]</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.remove_hydrogen_atoms"><code class="name flex">
<span>def <span class="ident">remove_hydrogen_atoms</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Removes hydrogen atoms from the chain.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_hydrogen_atoms(self):
    &#34;&#34;&#34;
    Removes hydrogen atoms from the chain.

    Returns:
        None
    &#34;&#34;&#34;
    for residue in self._residues:
        residue.remove_hydrogen_atoms()</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.remove_water_residues"><code class="name flex">
<span>def <span class="ident">remove_water_residues</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Removes water residues from the chain.</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_water_residues(self) -&gt; None:
    &#34;&#34;&#34;
    Removes water residues from the chain.

    Returns:
        None
    &#34;&#34;&#34;
    self._residues = [residue for residue in self._residues if not residue.residue_type == &#34;HOH&#34;]</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.renumber_residues"><code class="name flex">
<span>def <span class="ident">renumber_residues</span></span>(<span>self, new_numbers: Optional[List[int]] = None) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Renumbers the residues in the chain. Residues are numbered
sequentially, starting at 1.
If new_numbers is not specified,
the residues are numbered sequentially, starting at 1.
Insertion codes are removed.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>new_numbers</code></strong> :&ensp;<code>Optional[List[int]]</code></dt>
<dd>List of new residue numbers.
If not specified, the residues are numbered sequentially,
starting at 1.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p>
<h2 id="raises">Raises</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def renumber_residues(self, new_numbers: Optional[List[int]] = None) -&gt; None:
    &#34;&#34;&#34;
    Renumbers the residues in the chain. Residues are numbered
    sequentially, starting at 1.  If new_numbers is not specified,
    the residues are numbered sequentially, starting at 1.
    Insertion codes are removed.

    Args:
        new_numbers (Optional[List[int]]): List of new residue numbers.
            If not specified, the residues are numbered sequentially,
            starting at 1.

    Returns:
        None

    Raises:
        None
    &#34;&#34;&#34;
    if new_numbers is None:
        new_numbers = list(range(1, len(self._residues) + 1))

    for i in range(len(self._residues)):
        self._residues[i].sequence_no = new_numbers[i]
        self._residues[i].insertion_code = &#34;&#34;</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.seqres_analysis"><code class="name flex">
<span>def <span class="ident">seqres_analysis</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Compares the sequence of the chain to the SEQRES record.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def seqres_analysis(self):
    &#34;&#34;&#34;
    Compares the sequence of the chain to the SEQRES record.
    &#34;&#34;&#34;
    sequence_residues = self.get_attribute(&#34;seqres&#34;)
    structure_residues = [residue.residue_type for residue in self._residues if not residue.is_hetero]
    alignment1, alignment2 = Sequence.align(sequence_residues, structure_residues)
    return alignment1, alignment2</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.set_attribute"><code class="name flex">
<span>def <span class="ident">set_attribute</span></span>(<span>self, key: str, value: Any) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the value of the specified attribute.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>key</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the attribute.</dd>
<dt><strong><code>value</code></strong> :&ensp;<code>Any</code></dt>
<dd>The value of the attribute.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_attribute(self, key: str, value: Any) -&gt; None:
    &#34;&#34;&#34;
    Sets the value of the specified attribute.

    Args:
        key (str): The name of the attribute.
        value (Any): The value of the attribute.

    Returns:
        None
    &#34;&#34;&#34;
    if value is not None:
        setattr(self, &#34;_&#34; + key, value)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.sum_attribute"><code class="name flex">
<span>def <span class="ident">sum_attribute</span></span>(<span>self, key: str) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Sums the value of the specified attribute.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sum_attribute(self, key: str) -&gt; None:
    &#34;&#34;&#34;
    Sums the value of the specified attribute.
    &#34;&#34;&#34;
    atrribute_sum = 0.0
    for residue in self._residues:
        if not hasattr(residue, key):
            residue.sum_attribute(key)
        atrribute_sum += residue.get_attribute(key)
    self.set_attribute(key, atrribute_sum)</code></pre>
</details>
</dd>
<dt id="protkit.structure.chain.Chain.summary"><code class="name flex">
<span>def <span class="ident">summary</span></span>(<span>self) ‑> str</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def summary(self) -&gt; str:
    text = [
        f&#34;Chain ID: {self.id}&#34;,
        f&#34;Number of residues: {self.num_residues}&#34;,
        f&#34;Number of atoms: {self.num_atoms}&#34;
    ]

    return &#34;\n&#34;.join(text)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="protkit.structure" href="index.html">protkit.structure</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="protkit.structure.chain.Chain" href="#protkit.structure.chain.Chain">Chain</a></code></h4>
<ul class="">
<li><code><a title="protkit.structure.chain.Chain.add_residue" href="#protkit.structure.chain.Chain.add_residue">add_residue</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.atoms" href="#protkit.structure.chain.Chain.atoms">atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.chain_id" href="#protkit.structure.chain.Chain.chain_id">chain_id</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.copy" href="#protkit.structure.chain.Chain.copy">copy</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.delete_attribute" href="#protkit.structure.chain.Chain.delete_attribute">delete_attribute</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.extra_heavy_atom_types" href="#protkit.structure.chain.Chain.extra_heavy_atom_types">extra_heavy_atom_types</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.extra_hydrogen_atom_types" href="#protkit.structure.chain.Chain.extra_hydrogen_atom_types">extra_hydrogen_atom_types</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.filter_atoms" href="#protkit.structure.chain.Chain.filter_atoms">filter_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.filter_residues" href="#protkit.structure.chain.Chain.filter_residues">filter_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.fix_disordered_atoms" href="#protkit.structure.chain.Chain.fix_disordered_atoms">fix_disordered_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.get_attribute" href="#protkit.structure.chain.Chain.get_attribute">get_attribute</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.get_residue" href="#protkit.structure.chain.Chain.get_residue">get_residue</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.has_attribute" href="#protkit.structure.chain.Chain.has_attribute">has_attribute</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.id" href="#protkit.structure.chain.Chain.id">id</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.keep_atoms" href="#protkit.structure.chain.Chain.keep_atoms">keep_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.keep_backbone_atoms" href="#protkit.structure.chain.Chain.keep_backbone_atoms">keep_backbone_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.missing_heavy_atom_types" href="#protkit.structure.chain.Chain.missing_heavy_atom_types">missing_heavy_atom_types</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.missing_hydrogen_atom_types" href="#protkit.structure.chain.Chain.missing_hydrogen_atom_types">missing_hydrogen_atom_types</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_atoms" href="#protkit.structure.chain.Chain.num_atoms">num_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_disordered_atoms" href="#protkit.structure.chain.Chain.num_disordered_atoms">num_disordered_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_disordered_residues" href="#protkit.structure.chain.Chain.num_disordered_residues">num_disordered_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_heavy_atoms" href="#protkit.structure.chain.Chain.num_heavy_atoms">num_heavy_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_hetero_atoms" href="#protkit.structure.chain.Chain.num_hetero_atoms">num_hetero_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_hetero_residues" href="#protkit.structure.chain.Chain.num_hetero_residues">num_hetero_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_hydrogen_atoms" href="#protkit.structure.chain.Chain.num_hydrogen_atoms">num_hydrogen_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_residues" href="#protkit.structure.chain.Chain.num_residues">num_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_residues_by_type" href="#protkit.structure.chain.Chain.num_residues_by_type">num_residues_by_type</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.num_water_residues" href="#protkit.structure.chain.Chain.num_water_residues">num_water_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.protein" href="#protkit.structure.chain.Chain.protein">protein</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.remove_atoms" href="#protkit.structure.chain.Chain.remove_atoms">remove_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.remove_hetero_residues" href="#protkit.structure.chain.Chain.remove_hetero_residues">remove_hetero_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.remove_hydrogen_atoms" href="#protkit.structure.chain.Chain.remove_hydrogen_atoms">remove_hydrogen_atoms</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.remove_water_residues" href="#protkit.structure.chain.Chain.remove_water_residues">remove_water_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.renumber_residues" href="#protkit.structure.chain.Chain.renumber_residues">renumber_residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.residues" href="#protkit.structure.chain.Chain.residues">residues</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.seqres_analysis" href="#protkit.structure.chain.Chain.seqres_analysis">seqres_analysis</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.sequence" href="#protkit.structure.chain.Chain.sequence">sequence</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.set_attribute" href="#protkit.structure.chain.Chain.set_attribute">set_attribute</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.sum_attribute" href="#protkit.structure.chain.Chain.sum_attribute">sum_attribute</a></code></li>
<li><code><a title="protkit.structure.chain.Chain.summary" href="#protkit.structure.chain.Chain.summary">summary</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>